# ch02. 네트워크
## 2.1 네트워크 기초
네트워크 : 노드(node)와 링크(link)가 서로 연결되어 있거나 연결되지 않은 집합체
* 노드 : 서버, 라우터, 스위치 등 네트워킹 장비
* 링크 : 유선/무선 (연결)

### 2.1.1 처리량과 지연 시간
좋은 네트워크? : 많은 처리량, 짧은 지연시간, 적은 장애빈도, 좋은 보암
* 처리량(throughput)
  * 링크를 통해 전달되는 단위 시간당 데이터양
  * bps(bits per seconds)
* 지연시간(latency)
  * 요청이 처리되는 시간
  * 두 장비 사이를 왕복하는데 걸린 시간

### 2.1.2 네트워크 토폴로지와 병목현상
네트워크 토포로지
* 노드와 링크가 어떻게 배치되어 있는지...
* 트리 토폴로지 : 계층형 토폴로지. 노드 추가, 삭제가 쉬우며 특정 노드에 트래픽이 집중될 때 하위 노드에 영향 줄 수 있음
* 버스 토폴로지 : 중앙 통신 회선 하나에 여러 노드가 공유되어 연결되는 구성. LAN에서 사용. 스푸핑 이슈
  * 스푸핑 : LAN상에서 송신부의 패킷을 송신과 관련 없는 다른 호스트에 가지 않도록 하는 스위칭 기능을 마비시키거나 속여서 특정 노드에 다른 패킷이 오도록 하는 것... => 내 언어로 정리 : 패킷 가로채는거~
* 스타 토폴로지(star, 성형) : 중앙 노드에 모두 연결된 네트워크 구성. 노드 추가, 에러 탐지에 용이하고 패킷 충돌 발생 가능성이 적음. 그런데 중앙노드 장애 발생하면 전체 장애.. 설치 비용이 고가
* 링(ring)형 토폴로지 : 각 노드가 양옆 두 노드와 연결해 고리처럼 연결된 망. 데이터가 노드에서 노드로 이동.. => 네트워크 구성 변경이 어렵고, 회선 장애 발생하면 정체 네트워크에 영향
* 메시(MESH)토폴로지 : 망형 토폴로지. 그물망처럼 연결됨. 한 단말에 장애 발생해도 여러 경로 존재해서 네트워크 계속 사용할 수 있고 분산처리 가능. 그런데 노드 추가 어렵고 구축비용, 운용비용이 고가임....

병목현상
* 토폴로지가 중요한 이유 : 병목현상 기준이 된다~
* 뭔가 병목이 일어나서 지연시간 길어지고 있으면, 토폴로지 파악해서 회선을 추가함...
* bottlenect(병목) : 전체 시스템 성능, 용량이 하나의 구성요소로 인해 제한 받는 현상

### 2.1.3 네트워크 분류
* LAN : 사무실 규모
* MAN : 시 규모
* WAN : 전 세계 규모

LAN -> WAN 으로 갈수록 혼잡하고 느려짐

### 2.1.4 네트워크 성능 분석 명령어
코드상 문제 없는데 데이터 못가져온다? 대부분 병목현상이다~ 

병목현상 원인
* 네트워크 대역폭
* 네트워크 토폴로지
* 서버 CPU, 메모리 사용량
* 비효율적 네트워크 구성

`ping`
* 네트워크 상태 확인하기 위해 대상 노드를 향해 일정 크기 패킷 전송하는거
* 핑-퐁 할때 핑으로 이해했었음... 패킷을 주고 살아있니? 물으면 퐁 와서 살아있어~ 하는
* 패킷 수신을 받아서 잘 연결되어 있는지를 확인함.
* ICMP 프로토콜로 움직이기 때문에, traceroute 차단하거나 ICMP 차단하면 ping 불가함

`netstat`
* 서비스 네트워크 상태 표시하는데 사용...
* 주로 어떤 서비스 포트 열렸는지 확인하는데 씀

`nslookup`
* DNS 에 어떤 IP 매핑되었는지 확인하는데 씀

`tracert` 리눅스는 `traceroute`
* 네트워크 경로 확인할 때 사용하는 명령... 목적지까지 어떤 경로로 가냐..

### 2.1.5 네트워크 표준화
* IEEE 또는 IETF 표준화가 정의한 프로토콜...

## 2.2 TCP/IP 4계층 모델
인터넷 프로토콜 스위트는 컴퓨터들이 정보 주고받는데 쓰이는 프로토콜 집합.. TCP/IP 4계층 혹은 OSI 7계층으로 설명함

### 2.2.1 계층 구조
TCP/IP의 4계층 모델과 달리 OSI7계층은 애플리케이션 계층을 (애플리케이션/프레젠테이션/세션)계층으로 쪼개고 링크계층을 (데이터링크/물리)계층으로 쪼갬

* 애플리케이션 계층
  * 응용 프로토콜 계층
  * 웹서비스, 이메일 등 서비스를 실질적으로 클라이언트에 제공
  * HTTP, FTP, SSH, SMTP, DNS 등
* 전송 계층
  * 애플리케이션과 인턴계층 사이의 중계역할. 데이터 스트립을 지원
  * TCP/UDP
* 인터넷 계층
  * 네트워크 패킷을 IP주소로 전송
  * IP, ARP, ICMP 등...
  * 잘 받았는지 중요하지 않음(비연결형)
* 링크 계층 
  * 전선, 광섬유, 무선 등.. 실질적으로 데이터를 전달하며 장치간 신호를 주고받는 규칙을 정하는 계층
  * 네트워크 접근 계층
  * 물리계층 : 유무선LAN을 통해 이진데이터를 보내는 계층 / 데이터링크계층: 이더넷 프레임을 통해 에러확인, 흐름제어, 접근제


데이터 송신 : 애플리케이션 -> 전송 -> 인터넷 -> 링크    
데이터 수신 : 링크 -> 인터넷 -> 전송 -> 애플리케이션

### 2.2.2 PDU
* 네트워크가 전달 도리 때의 단위
* 메타데이터 '헤더', 실제 데이터 '페이로드'
* PDU를 각 계층마다 부르는 명칭
  * 애플리케이션 : 메세지
  * 전송 : 세그먼트(TCP), 데이터그램(UDP)
  * 인터넷 : 패킷
  * 링크 : 프레임(데이터링크), 비트(물리)


## 2.3 네트워크 기기
### 2.3.1 네트워크 기기 처리 범위
네트워크 기기는 계층 별로 처리 범위 나눈 수 있음... 각 계층을 처리할 수 있는 기기.  
상위 계층 기기는 하위 계층 처리 할 수 있지만, 그 반대는 불가. => L7스위치는 애플리케이션 처리 기기.. 그 아래 모든 프로토콜 제어 가능 / AP는 물리계층만 처리
* 애플리케이션 : L7스위치
* 인터넷 계층 : L3스위치, 라우터
* 데이터링크 : 브리지, L2스위치
* 물리 : NIC, 리피터, AP

### 2.3.2 애플리케이션 처리 기기
L7 스위치
* 여러 장비 연결하고 데이터 통신 중재, 목적지가 연결된 포트로만 전기신호 보내서 데이터 전송하는 네트워크 장비
* 로드밸런서라 하기도 함
* 서버 부하 부산하는 기기
* 클라이언트로 오는 요청을 뒤의 여러 서버로 나누는 역할. 시스템이 처리할 수 있는 트래픽을 증가시키는 것을 목적으로 함
* 응용 프로그램 수준의 트래픽 모니터링, 바이러스/불필요데이터 등을 걸러내는 필터링 기능도 있음
* helth check
  * 장애 발생 서버가 있다면 제외시켜야 함... 헬스체크를 통해 주기적으로 감시
* L4 vs L7
  * L4스위치도 로드밸런서가 있음.
  * L4스위치는 인터넷 기능 처리하는 기기로, 스트리밍 서비스는 사용불가. IP/Port기반으로 트래픽을 분산함
  * L7스위치는 IP/Port 외에도 URL/HTTP헤더/쿠키 등을 기반으로 트래픽 분산 시킬 수 있음
  * AWS에서 L7로드밸러서는 ALB 컴포넌트로 하고, L4로드밸런서는 NLB rlqksdmfh gka
* 로드밸런서를 통해 서버 이중화를 해서 안정적으로 운영함


### 2.3.3 인터넷 계층 처리 기기
라우터
* 여러 네트워크를 연결/분한/구분
* 다른 네트워크 장치끼리 데이터를 주고받을 때 패킷소모 최소화하고 경로 최적화하여 최소 경로로 패킷 포워딩

L3 스위치
* L2 스위치 + 라우터
* 라우터라 봐도 무방..

### 2.3.4 데이터 링크 계청 처리 기기
L2스위치
* 장치들의 MAC 주소를 관리, 정결 장치로 패킷 왔을 때 패킷 전송
* IP 기반 라우팅은 불가

브리지
* 두 개 LAN을 상호 접속 할 수 있도록 하는 연결장치
* MAC - MAC 연결
* 서로 다른 LAN을 하나의 통신망으로 구축할 때 쓰임

### 2.3.5 물리 계층 처리 기기
NIC
* LAN 카드
* 2대 이상 컴퓨터 네트워크를 구성하는데 쓰임
* 네트워크와 빠른 속도로 데이터 송수신하도록 컴퓨터 내에 설치하느 확장 카드

리피터 
* 들어온 약해진 신호를 증폭해서 다른 쪽으로 전달
* 패킷 더 멀리 갈 수 있음 ~ 근데 광케이블 들어오면서 잘 안쓰임

AP
* 패킷 복사 기기

## 2.4 IP주소
### 2.4.1 ARP


## 2.5 HTTP

## 질문
* 트리 토폴로지와 버스 토폴로지의 차이를 설명하고 예시를 드세요.
  * 도커랑 K8S로 구성한 서버도 토폴로지로 설명할 수 있는지?
  * 메세지 큐 서버 구조도 토폴로지로 설명할 수 있는지?
  * 몽고 샤딩도 토폴로지로 설명 가능?
* 라이브 서비스 중인 서버는 어떻게 구성이 되어 있나요? 점검 시 어떤 순서로 패치를 진행하나요? 네트워크 기기와 토폴로지로 설명해보세요